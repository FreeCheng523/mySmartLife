# 3.2 控制数据结构定义

## 3.2.1 控制

| 字段 | 长度(字节) | 说明 |
|------|------------|------|
| HEADER | 1 | 控制指令HEADER数值为0x2 |
| KEY_CODE | 1 | 按键定义，参考按键KEY_CODE |
| RESERVE | 2 | 保留字段 |

## 3.2.2 KEY_CODE

### 3.2.2.1 定义

- Key code定义了妥妥贴上的按键、旋钮，支持长按、短按(点击)、双击，旋钮。
- 每个字节的前2位代表短按、长按、双击，第3-4位为标志位，后4位代表键值。旋钮只有键值有效
- 短按：00，长按：01，双击：10

### 3.2.2.2 用例

第一个字节：
长按为01:              标志位                 按钮键位0x01:
```
0	1	0	0	0	0	0	1
```

### 3.2.2.3 组合表格

| 值(十六进制) | 说明 |
|--------------|------|
| KEY_SHORT_PRESS | 0x01 | 短按按钮键 |
| KEY_DOUBLE_CLICK | 0x81 | 双击按钮键 |
| KNOB_CLOCKWISE | 0x02 | 旋钮正旋 |
| KNOB_ANTICLOCKWISE | 0x03 | 旋钮反旋 |
| REVERSE_CONTROL_ENTER | 0xF1 | 进入反向控制 |
| REVERSE_CONTROL_EXIT | 0xF2 | 退出反向控制 |
| KEY_NONE | 0 | 无效值，代表按键未使能 |

### 3.2.2.4 二进制解析表格

| 名称 | 十六进制 | 二进制 | 按键类型 | 标志位 | 键值 | 说明 |
|------|----------|--------|----------|--------|------|------|
| KEY_SHORT_PRESS | 0x01 | 0000 0001 | 00 (短按) | 00 | 0001 | 短按按钮键 |
| KEY_DOUBLE_CLICK | 0x81 | 1000 0001 | 10 (双击) | 00 | 0001 | 双击按钮键 |
| KNOB_CLOCKWISE | 0x02 | 0000 0010 | - | - | 0010 | 旋钮正旋 |
| KNOB_ANTICLOCKWISE | 0x03 | 0000 0011 | - | - | 0011 | 旋钮反旋 |
| REVERSE_CONTROL_ENTER | 0xF1 | 1111 0001 | 00 (短按) | 11 | 0001 | 进入反向控制 |
| REVERSE_CONTROL_EXIT | 0xF2 | 1111 0010 | 00 (短按) | 11 | 0010 | 退出反向控制 |
| KEY_NONE | 0x00 | 0000 0000 | - | - | 0000 | 无效值，代表按键未使能 |

**二进制位解析说明：**
- **位7-6 (前2位)**：按键类型
  - `00`：短按
  - `01`：长按
  - `10`：双击
  - `11`：保留
- **位5-4 (第3-4位)**：标志位
  - 用于特殊功能标识
- **位3-0 (后4位)**：键值
  - 表示具体的按键或旋钮编号
- **旋钮说明**：旋钮只有键值有效，按键类型和标志位无意义
